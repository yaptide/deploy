# https://docs.ansible.com/ansible/latest/collections/ansible/builtin/git_module.html
- name: Git checkout
  ansible.builtin.git: # noqa: latest
    repo: 'https://github.com/yaptide/ui'
    dest: '{{ frontend_repo_workdir }}'
    version: '{{ frontend_repo_version }}'
  
- name: Build frontend
  community.docker.docker_container:
    name: node
    image: node
    working_dir: '/ui'
    command: /bin/bash -c "apt update; apt install -y python3-pip; pip install -r requirements.txt; npm install; npm run build"
    detach: false
    volumes:
      - '{{ frontend_repo_workdir }}:/ui'
  register: frontend_build_result

- name: Print frontend build result
  ansible.builtin.debug:
    msg: '{{ frontend_build_result }}'
